
<style>

.link {
  fill: #666;
  stroke: #666;
  stroke-width: 1.5px;
}

.node circle {
  fill: #CEF6CE;
  stroke: #666;
  stroke-width: 1px;
}

text {
  font: 11px sans-serif;
  pointer-events: none;
  text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, 0 -1px 0 #fff, -1px 0 0 #fff;
}

</style>
<body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
<script>

// http://blog.thomsonreuters.com/index.php/mobile-patent-suits-graphic-of-the-day/
var links = [
  {source: "CSE8A/8AL", target: "CSE8B"},
  {source: "CSE8B", target: "CSE12/15L"},
  {source: "CSE12/15L", target: "CSE30"},
  //{source: "CSE8B", target: "CSE20"},
  {source: "CSE20", target: "CSE21"},
  {source: "CSE30", target: "CSE100"},
  {source: "CSE21", target: "CSE100"},
  {source: "CSE100", target: "CSE101"},
  //{source: "CSE12/15L", target: "CSE110"},
  {source: "CSE100", target: "CSE110"},
  {source: "CSE110", target: "CSE112"},
  {source: "CSE30", target: "CSE120"},
  {source: "CSE101", target: "CSE120"},
  {source: "CSE20", target: "CSE140/140L"},
  {source: "CSE140/140L", target: "CSE141/141L"},
  {source: "CSE100", target: "CSE150"},
  {source: "CSE100", target: "CSE151"},
  {source: "CSE100", target: "CSE190(1)"},
  {source: "CSE100", target: "CSE190(2)"},
  {source: "CSE100", target: "CSE190(3)"},
  {source: "CSE100", target: "CSE198"},

  {source: "ECE35", target: "ECE45"},
  {source: "ECE35", target: "ECE65"},
  {source: "ECE45", target: "ECE101"},
  {source: "CSE140/140L", target: "ECE111"},

  {source: "MATH20C", target: "MATH20D"},  
  {source: "MATH20D", target: "ECE109"}, 
  {source: "MATH31AH", target: "ECE109"},   
  {source: "MATH31AH", target: "MATH109"},   
  {source: "MATH109", target: "MATH142A"},
  {source: "MATH142A", target: "MATH142B"},
  {source: "MATH31AH", target: "MATH170A"},   
  {source: "MATH170A", target: "MATH170B"},
  {source: "MATH170B", target: "MATH170C"},
  {source: "MATH109", target: "MATH184A"},
  {source: "MATH20D", target: "MATH152"},  
  {source: "MATH31AH", target: "MATH152"},   
  {source: "MATH109", target: "MATH277A"},   
  {source: "MATH31AH", target: "MATH102"},   
  {source: "MATH31AH", target: "MATH189"}

];

var nodes = {};

//setInterval(function(){force.alpha(0.1);},400);

// Compute the distinct nodes from the links.
links.forEach(function(link) {
  link.source = nodes[link.source] || (nodes[link.source] = {name: link.source});
  link.target = nodes[link.target] || (nodes[link.target] = {name: link.target});
});

var width = 960,
    height = 860;

var force = d3.layout.force()
    .nodes(d3.values(nodes))
    .links(links)
    .size([width, height])
    .linkDistance(90)
    .charge(-300)
    .on("tick", tick)
    .start();

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);


svg.append("defs").selectAll("marker")
    .data(["default"])
    .enter().append("marker")
    .attr("id", function(d) { return d; })
    .attr("viewBox", "0 -3 10 10")
    .attr("refX", 30)
    .attr("refY", -1)
    .attr("markerWidth", 5)
    .attr("markerHeight", 5)
    .attr("orient", "auto")
    .append("path")
    .attr("d", "M0,-5L10,0L0,5");

var path = svg.append("g").selectAll("path")
    .data(force.links())
    .enter().append("path")
    .attr("class", "link")
    .attr("marker-end", "url(#default)");

var circle = svg.selectAll(".node")
    .data(force.nodes())
    .enter().append("g")
    .attr("class", "node")
    .on("mouseover", mouseover)
    .on("mouseout", mouseout)
    .call(force.drag);

circle.append("circle")
      .attr("r", 12)

var text = svg.append("g").selectAll("text")
    .data(force.nodes())
    .enter().append("text")
    .attr("x", 19)
    .attr("y", ".50em")
    .text(function(d) { return d.name; });

function mouseover() {
  d3.select(this).select("circle").transition()
      .duration(750)
      .attr("r", 32);
}

function mouseout() {
  d3.select(this).select("circle").transition()
      .duration(750)
      .attr("r", 12);
}

function tick() {
  path.attr("d", link_style);
  circle.attr("transform", transform);
  text.attr("transform", transform);
}

function link_style(d) {
  var dx = d.target.x - d.source.x,
      dy = d.target.y - d.source.y,
      dr = dx * dx +  dy * dy;
  return "M" + d.source.x + "," + d.source.y + "A" + dr + "," + dr + " 0 0,1 " + d.target.x + "," + d.target.y;
}

function transform(d) {
  return "translate(" + d.x + "," + d.y + ")";
}

</script>
